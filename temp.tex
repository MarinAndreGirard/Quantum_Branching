\documentclass{article}
\usepackage{amsfonts}
\usepackage{braket}
\usepackage{amsmath}
\usepackage{bbm}
\usepackage{graphicx} % Required for inserting images
\usepackage[margin=2cm]{geometry} % Adjust the value of "2cm" to your desired margin size
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{comment}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=blue,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }

\urlstyle{same}






\title{Branching dynamics}
\author{marin.girard }
\date{February 2024}

\begin{document}

\maketitle

\section{Introduction}

\textbf{To run your own simulations varying the parameters, or see other sets of parameters already simulated see this
\href{http://github.com/MarinAndreGirard/Quantum_Branching}{Github repository}}\\
We establish the ACL model and then make a section for each of the following questions.

\paragraph{Does Branching dynamics split the energy eigenspace between the branches in a particular way?}
Do the worlds share it equally? Proportional to their respective probabilities?

\paragraph{Having established that they share the eigenstates weirdly. Why?}
What drives this dynamics? Does it generalize beyond the ACL model in which we observe this dynamics?

\paragraph{Can we get it all from the energy spectrum and the distribution of the global state in it?}

Energy spectrum + state defined in energy basis $\rightarrow$ sharing of Hilbert space by worlds $\rightarrow$ explain the phenomena we observed

\section{A measurement model}

\subsection{The Adapted Caldeira-Leggett dynamics}
To answer these questions, we consdier the adapted Caldeira-Leggett model, a system $\mathcal{S}$ + environment $\mathcal{E}$ where the system is a truncated SHO. Its Hamiltonian takes the form,
\begin{equation}    
    H_{tot}=H_s+H_e+E_IH_I
\end{equation}
We choose no self interaction for the truncated SHO, so $H_s=\mathbbm{1}\otimes\mathbbm{1}$, and we choose a random hermitian matrix for the environment self interaction $\mathbbm{1}\otimes H_r$, with $H_r$ a random hermitian matrix. The interaction Hamiltonian is $H_I=H_q\otimes H_r'$, with $(H_q)_{ij}=q_i\delta_{ij}$ and $H_r'$ another random hermitian matrix. This makes it so that the environment acts on the system depending on its state. \\
Taking the eigenstates of $H_q$ to be $\{|q_i\rangle\}\forall$, there is a basis like $\{|q_i\rangle|k_i\rangle\}$, such that $H_{tot}$, $H_e$ and $H_I$ take the a block diagonal form. $i\in[0,d_1-1],j\in [0,d_2-1]$, $d_1$ and $d_2$ the dimensions of the system and environment respectively, giving a total dimension $d=d_1*d_2$.
\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/Heat_He.png}
    \label{fig:1}
    \caption{Heat map of $H_e$}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/heat_HI.png}
    \label{fig:2}
    \caption{Heat map of $H_I$}
  \end{subfigure}
  \caption{}
  \label{fig:dist_EI_dep}
  \caption{Heat map of the Hamiltonians $H_e$ and $H_I$ in the eigenbasis of $H_{tot}$, for $d_1=10,d_2=200$. We note the $d_1$ degeneracy of the spectrum of $H_e$ and the no degeneracy of $H_I$. By our constrution, there is no degeneracy for $H_{tot}$}
\end{figure}

\subsection{The state}

We choose our initial state to be a separble state with $|e\rangle$ an environment state,
\begin{equation}
    |\psi(0)\rangle=(\sqrt{w}|q_1\rangle+\sqrt{1-w}|q_2\rangle)|e\rangle
\end{equation}
this corresponds to a superposition of energy eigenstates not yet entangled with an environment. $w$ is the probability of being in $|q_1\rangle$. We also define here the eigenstates of $H_{tot}$ to be $\{|q_i\rangle|k_i\rangle\}$. Note the fact that $|k_i\rangle$ depends on $q_i$. This is because each block of $H_{tot}$ is different, meaning that it diagonalizes in different basis. More precisely, we can isolate the $d_1$ Hamiltonians that act on our environment depending on $q_i$, but since they do not commute, they do not share a common eigenbasis. Note that we can use a basis defined without $q_i$ dependance in the $k$ terms in the $H_I$ dominated limit or the $E_I=0$ limit (that last one is less interesting).


\subsection{Time evolution and decoherence}

%the Schmidt states are $|S_i(t)\rangle = |q_1\rangle\sum_k\alpha_k|v_k\rangle + |q_2\rangle\sum_k\beta_k|v_k\rangle$, so defined over $2*d_2$ out of $d_1*d_2$ energy eigenbasis basis states. 
%In the basis $\{|q_i\rangle|k\rangle\}$, in which $H_{tot}, H_{I}, H_e$ are block diagonal, 
With this in mind, our initial state is only defined in $2d_2$ out of $d$ energy eigenstates. Thus to understand the action of the $e^{-itH_{tot}}$ on our state, we only need to consider 3 different $d_2*d_2$ matrices, $H_r, E_Iq_1H_r', E_Iq_2H_r'$ (or 2 if we consider $H_{tot}$). We can write the time evolution,
\begin{align}
    |\psi(t)\rangle &= e^{-itH_{tot}}|\psi(0)\rangle\\
    &=e^{-itH_{tot}}|q_1\rangle\sqrt{w}|e\rangle+e^{-itH_{tot}}|q_2\rangle\sqrt{1-w}|e\rangle\\
    &=|q_1\rangle\sqrt{w}e^{-it(H_e^{(1)})}|e\rangle+|q_2\rangle\sqrt{1-w}e^{-it(H_e^{(2)})}|e\rangle\\
    &= |q_1\rangle\sqrt{w}|\mathcal{E}_1(t)\rangle+|q_2\rangle\sqrt{1-w}|\mathcal{E}_2(t)\rangle\\
    %&= A(t)|q_1\rangle|E_1(t)\rangle+B(t)|q_2\rangle|E_2(t)\rangle\\
    %&=|q_1\rangle e^{-it(H_r + E_Iq_1H_r')}|E_1(t)\rangle+|q_2\rangle e^{-it(H_r + E_Iq_2H_r')}|E_2(t)\rangle
%    |S_0(t)\rangle+|S_1(t)\rangle\\    =e^{-it()}
\label{eq:time_evo_global}
\end{align}
We defined, $H_e^{(1)}=H_r + E_Iq_1H_r'$ and $H_e^{(2)}=H_r + E_Iq_2H_r'$, two matrices acting on $\mathcal{E}$.\\

\subsubsection{Existence of pointer states}
Block diagonal Hamiltonians always allow for certain pointer states (See "A Search for Classical Subsystems in Quantum Worlds" Appendix A)\\

\begin{comment}
(Question, could we find one who's entanglement is not zero, but stays constant??? is it the case for a superposition of pointer states here? pointer stats on diff qi's??)
Thinking about it, that would be a state such that the off diagonal terms are non-zero and dont really vary in time.
or a state that cant be written as a separable pure state (ie superposition of 2 such state for ex) but where the relative weights of the 2 separable states stay the same. I think we can essentially express entanglement as a function of the relative weight of the 2 Schmidt states. if one dominates, then low entanglement, if they share weights pretty well then high entrop.
\end{comment}
We find that $|q_i\rangle|E_i(t)\rangle = |p_i(t)\rangle$ are global pointer states since the time evolution leaves the state as a separable state. In the total energy eigenbasis, a pointer state is defined in a $d/d_1$ subspace at most (and would need to be fine tuned to be defined in a smaller state). Technically, pointer states would be defined on the system, but we consider here an extension to the full Hilbert space, since our system has no self interaction.\\
 %(Although, maybe the fact that we can look at H_I in different basis, raises more questions.)


\begin{comment}
    $H_{tot}$ is block diagonal. This affords it some nice properties. Notably that its eigenstates can be written as $\{|q_i\rangle|j\rangle\}=\{|i\rangle_w\}\forall i\leq d_1,j\leq d_2$. We then get to re-write it,
\begin{equation}
    H_{tot}=\sum_k|q_k\rangle \langle q_k|\otimes\sum_lE_{kl}|l\rangle\langle l| = \sum_k|q_k\rangle \langle q_k|\otimes H^{(k)}_t
\end{equation}
%Claim is that it is always possible to find a unitary $B$, such that we get pointer states $|p_i(t)\rangle = Be^{-itH_{tot}}|q_i\rangle|E_i\rangle$, such that it remains un-entangled for all time, ie separable. 

Diagonalize $H_{tot}=W^{\dagger}DW$ with $D=\sum_i\lambda_i|i\rangle_w \langle i|_w$, with the $\lambda_{i}$ the eigenvalues of $H_{tot}$. Then, any state defined by $E|q_i\rangle|E_i\rangle$ for $|E_i\rangle$ any state defined on the environemnt, is a pointer state.
To see this, evolve it in time by ,
\begin{align*}
    W^{\dagger}e^{-itH_{tot}}W|q_i\rangle|\psi_e\rangle = W^{\dagger}We^{-itD}W^{\dagger}W|q_i\rangle|\psi_e\rangle \\
    = |q_i\rangle e^{-itH^{(i)}_e}|\psi_e\rangle \\
    = |q_i\rangle|\psi_e(t)\rangle
\end{align*}
\end{comment}

\subsubsection{Decoherence}

The initial state is separable with,
\begin{align*}
    \rho(0)=|\psi(0)\rangle\langle \psi(0)| \\
    \rho_s(0) = Tr_e[\rho(0)] \\
    \rho_e(0)= Tr_s[\rho(0)]
\end{align*}
We have in the $\{|q_i\rangle\}$ basis,
\begin{equation}
    \rho_s(0) = (|q_1\rangle\sqrt{w}+|q_2\rangle\sqrt{1-w})(\langle q_1|\sqrt{w}+\langle q_2|\sqrt{1-w}) = 
    \begin{pmatrix}
        0 & ... & & ... & 0 \\
        ... & w & ... & \sqrt{w(1-w)} & ... \\
        ... & 0 & ... & 0 & ... \\
        ... & \sqrt{w(1-w)} & ... & (1-w) & ... \\
        0 & ... & & ... & 0 \\
    \end{pmatrix}
    \label{eq:rhos0}
\end{equation}
In a basis $\{|q_1\rangle\sqrt{w}+|q_2\rangle\sqrt{1-w},...\}$ it is diagonal with only one non-zero eigenvalue $\lambda_0=1$.
After some time we get,
\begin{align}
    \rho(t) =(|q_1\rangle \sqrt{w}|\mathcal{E}_1(t)\rangle+|q_2\rangle \sqrt{1-w}|\mathcal{E}_2(t)>)*(\cdots)^{\dagger}\\
    %=(|q_1\rangle\sqrt{w}\sum_jc_j(t)|j\rangle+|q_2\rangle\sqrt{w}\sum_jc_j'(t)|j>)*(\cdots)^{\dagger} \\
    \implies\rho_s(t)=Tr_e[\rho(t)]
    =\begin{pmatrix}
        0 & ... & & ... & 0 \\
        ... & w & ... & \sqrt{w-w^2}\sum_k\langle k|\mathcal{E}_2(t)\rangle\langle\mathcal{E}_1(t)|k\rangle & ... \\
        ... & 0 & ... & 0 & ... \\
        ... & \sqrt{w-w^2}\sum_k\langle k|\mathcal{E}_1(t)\rangle\langle\mathcal{E}_2(t)|k\rangle & ... & 1-w & ... \\
        0 & ... & & ... & 0 \\
    \end{pmatrix}\\
    %=\begin{pmatrix}
     %   0 & ... & & ... & 0 \\
     %   ... & w\sum_k|c_k(t)|^2 & ... & \sqrt{w-w^2}\sum_kc_k(t)c_k'^*(t) & ... \\
     %   ... & 0 & ... & 0 & ... \\
     %   ... & \sqrt{w-w^2}\sum_kc_k^*(t)c_k'(t) & ... & (1-w)\sum_k|c_k'(t)|^2 & ... \\
     %   0 & ... & & ... & 0 \\
    %\end{pmatrix}
    %(|q_1\rangle A_1(t)\sum_jc_j(t)|e_j\rangle+|q_2\rangle A_2(t)\sum_jc_j'(t)|e_j>)*(\cdots)^{\dagger} \\
    \label{eq:rhost}
\end{align}
We used here $\{|k\rangle\}$ a basis for the environment that is not one of the $\{|k_i\rangle\}$. This means that $|\mathcal{E}_1\rangle=\sum_kc^{\mathcal{E}_1}_k(t)|k\rangle$ with the $c^{\mathcal{E}_1}_k(t)$'s not just phases and actually varying in amplitude. We see this using the expression of the $|k_1\rangle$ basis states in the $|k\rangle$ basis,
\begin{align}
    |\mathcal{E}_1\rangle=\sum_{k_1}e^{-itk_1}c_{k_1}|k_1\rangle\\
    =\sum_{k_1}e^{-itk_1}c_{k_1}\sum_ka^{(k_1)}_k|k_\rangle\\
    =\sum_k(\sum_{k_1}e^{-itk_1}c_{k_1}a^{(k_1)}_k)|k\rangle
\end{align}
The term $(\sum_{k_1}e^{-itk_1}c_{k_1}a^{(k_1)}_k)=c^{\mathcal{E}_1}_k(t)$ has varying norm. \\

Or density matrix is already in the pointer basis $|p_i\rangle=|q_i\rangle$ so decoherence would be diagonalization in this basis, ie $|\langle\mathcal{E}_1|\mathcal{E}_2\rangle|^2=|r(t)|^2\rightarrow0$. We get for the diagonal term,
\begin{align}
    \langle \mathcal{E}_1| \mathcal{E}_2\rangle(t) = \sum_k(c^{\mathcal{E}_1}_k)^{\dagger}(t)c^{\mathcal{E}_2}_k(t)
\end{align}



\subsubsection{Decoherence by variance}
What do we know about $c^{\mathcal{E}_i}_k$? It is a complex number with norm varying between 0 and 1 with a normalization condition $\sum_k|c^{\mathcal{E}_i}_k|^2=1$. Suppose after some time $t$, they are Gaussian distributed $\mathbb{E}(c^{\mathcal{E}_i}_k)=0$. Then $\mathbb{E}(\sum_kc^{\mathcal{E}_i}_k)=0$, and we know that $|Var(\sum_kc^{\mathcal{E}_i}_k)|\leq 1$ .We can also suppose that after some time, the $c^{\mathcal{E}_1}_k$ and $c^{\mathcal{E}_2}_k$ are independant. 
Then,\\
FIND WAY TO BOUND VARIANCE EXPONENTIALLY IN $D_2$..\\
Note, we neglected the independance of the $c^{\mathcal{E}_i}_k$ (leading to probabilities).\\

\begin{comment}
    
The $c_j$ are random complex with mean $\mathbb{E}(c_k)=0$ and variance $Var(c_k)=\mathbb{E}(|c_k|^2)=(\frac{1}{d_2})^2$, which means that $\mathbb{E}(\sum_kc_k)=0$ and $Var(\sum_kc_k)=\frac{1}{d_2}$. By the independance of $c_k$ and $c_k$', we have that
\begin{align*}
    \mathbb{E}_{c_k,c_k'}(\sum_kc_kc_k')= \sum_k\mathbb{E}_{c_k}(c_k)\mathbb{E}_{c_k'}(c_k')=0\\
    Var(\sum_kc_kc_k') = ...
\end{align*}
Want to conclude here that the variance gets smaller with environment size.....This is like a random walk on the complex plan, with gaussian distributed distances and uniform distributed directions. It
%That all depends on what I did for the variance thing. I kind of cheated things.
We conclude from this that the environment states are such that $\langle \mathcal{E}_j(t)|\mathcal{E}_i(t)\rangle\approx \delta_{ij}$ at times post decoherence (ie having given the environemnt time to evolve $|e_i\rangle$ into two independant states. Note that the 2 states it evolves in are independant because they evolve according to different). Another way we can see this is by looking directly at the time evolution,
\begin{equation}
    \langle \mathcal{E}_1(t)|\mathcal{E}_2(t)\rangle = \langle e|e^{itH_e^{(1)}}e^{-itH^{(2)}_e}|e\rangle = \langle e|e^{-it(E_I(q_2-q_1)H_r')}|e\rangle 
\end{equation}
The random variable $\langle e|e^{-it(E_I(q_2-q_1)H_r')}|e\rangle$ has mean 0, and variance (we take $\mathcal{E}[|X|^2]$ for the variance ),
\begin{align*}
    Var[\langle e|e^{-it(E_I(q_2-q_1)H_r')}|e\rangle] =\mathcal{E}[\sum_{jk}|c_j|^2|c_k|^2e^{-it(\epsilon_j-\epsilon_k)}]\\
    =\sum_{jk}\mathcal{E}[|c_j|^2|c_k|^2e^{-it(\epsilon_j-\epsilon_k)}]\\
    =...
\end{align*}
\end{comment}

\subsubsection{Decoherence by unit sphere}
Other way of explaining away decoherence, we give each term the same amplitude and just look at phases. We have a sum of a bunch of random phases. Or simply, we can see it as the overlap of 2 random quantum states, ie 2 random vectors on the unit sphere of the Hilbert space (of dimension $2d_2-1$). Doing that, we set $|\mathcal{E}_1\rangle=(1,0,....,0)$, meaning we now only need to care about the zero value of a random vector on the unit sphere ($|\mathcal{E}_2\rangle=(r_1, ...r_2)$). It turns out that the distribution of $r_i$ for points randomly selected on the sphere (the $r_i$'s are points in $2n-1$ real space) is such that it is distributed according to approximately $(1+r_1)^{d_2}(1-r_1)^{d_2}$, which means that the mean of $r_1$ is approximately $B(d_2+1/2,d_2+1/2)\approx\frac{\Gamma(d_2-1/2)\Gamma(d_2+1/2)}{\Gamma(2*d_2)}$.
%source https://math.stackexchange.com/questions/2977867/x-coordinate-distribution-on-the-n-sphere


\subsubsection{Decoherence other}
If we had a bosonic heat bath then the issue is already solved by Zurek in "Coherent States via Decoherence". 
\begin{comment}
We find pointer states $|q_1\rangle = (\hat{a}^{\dagger})^{q_1}|0\rangle$, not a coherent state/  Note that this goes against what Andreas is saying, which is that we have position eigenstaes as pointer states, which would be $b(\hat{a}^{\dagger}+\hat{a})$. ( Zurek's paper Coherent States via Decoherence) (does my paper go against this?). 
\end{comment}



a way to explain the decoherence is as a washing away of a delicate balance.
keeping, particularly, $|\mathcal{E}_1(t)\rangle$ and $|\mathcal{E}_2(t)\rangle$ start defined by the same set of set of amplitudes and phases in the $|k\rangle$ basis, but then each starts essentially evolving independantly of each other.




What is the delicate balance I am washing away here??

A coherent state is the specific quantum state of the quantum harmonic oscillator, often described as a state that has dynamics most closely resembling the oscillatory behavior of a classical harmonic oscillator.Mathematically, a coherent state is defined to be the (unique) eigenstate of the annihilation operator Ã¢.
This leads me to a confusion. I am starting my state in a superposition of 2 eigenstates of the SHO. The $|q_i\rangle$'s are not position states but coherent states, ie eigenstates of the SHO ie eigenstates of $\hat{a}\hat{a^{\dagger}}$. So as Zurek says, the ACL model leads in its non-trivial limit, to pointer states that are coherent states.




What happens is that as interaction starts, the density matrix de-diagonalizes as it becomes non-classical (ie increaes entanglement). And then becomes diagonal again, from 1 to 2 non-zero eigenvalues. 

Anyways to understand that the off diagonal terms become first highly non-zero, and then go to zero again?


For an arbitrary initial pure state, the system density matrix becomes diagonal in the pointer basis.
SEE MY INITIAL STATE
then find the reduced density matrix
note that it depends on $c_{ij}(t)=\langle \phi_i(t)|\phi_j(t) \rangle$, where, using the fact that the environment drives the environment states into approximately orthogonal states, we have $c_{ij}\approx \delta_{ij}$


Decoherence induced pointer states for our particular block diagonal case are such that they are defined over a limited subspace of the hilbert space. it is usefull to think of the Hilert space in the total energy eigenbasis, since in it, we see that the pointer states are defined in $d_{tot}/d_1=d_2$ energy eigenbasis states. And importantly, 2 pointer states defined with different $|q_i\rangle$ have no energy eigenstate in common (supposing no degeneracy.)

\subsubsection{Decoherence time}

We study a simple case, the limit where the interaction strength dominates. This implies that the blocks in the Hamiltonian are diagonalizable together (because of our specific construction). We get from this, that $|\mathcal{E}_i\rangle=\frac{1}{\sqrt{d_2}}\sum_ke^{-itE^{(i)}_k}|k\rangle$. (Where we also assumed that we started in a uniformly distributed state). Of note, is that this implies that our 2 worlds's porbability vecotrs (in total energy eigenspace) will have constant non-zero overlap. Still this makes the state overlap (ie orthogonality in Hilbert space) easier to study,
\begin{align}
    r(t)=\langle\mathcal{E}_1|\mathcal{E}_2\rangle = \frac{1}{d_2}\sum_ke^{-it(E_k-E_k')}\\
\end{align}
We study the case where the energy spectrums of $H_e^{(i)}$ is uniform, $E_k=q_1k$ and $E_k'=q_2k$, also defining $q_1-q_2=f$. We apply the next simplification. We now look at $|r(t)|^2$,
\begin{align}
    |r(t)|^2=\frac{1}{d_2^2}|\sum_ke^{-itkf}|^2\\
    =\frac{1}{d_2^2}\sum_{kj}e^{-itk(1-f)+itjf}\\
    =\frac{1}{d_2^2}(d_2+\sum_{k\neq j}e^{-it(k-j)f})\\
    =\frac{1}{d_2^2}(d_2+2\sum^{d_2}_{k=1}(d_2-k)cos(ktf))\\
\end{align}
Where what we end up with is a sum that has terms of higher importance than others (the low $k$'s have a higher weight.). Fully time symmetric as expected of unitary evolution, as well as periodic with period $T_p=\frac{2\pi}{f}$.  
For $d_2=5$, we get that $\sum^{d_2}_{k=1}(d_2-k)cos(ktf)$ has the form of Fig.~(\ref{fig:r_plot})
\begin{figure}
    \centering
    \includegraphics[scale=0.2]{Figures/r_plot.png}
    \caption{For $d_2=5$, plot of  $\sum^{d_2}_{k=1}(d_2-k)cos(ktf)$. It would seems reasonable to define the decoherence time the first local minima around 0.}
    \label{fig:r_plot}
\end{figure}

\paragraph{Decoherence time dependence on $q_2$ and $q_1$:} By time symmetry of the solution, we choose to consider $q_2$ superior to $q_1$ and redefine $f\rightarrow-f$ just to keep things positive.
Suppose we have a $T_{dec}$, such that $|r(T_{dec})|^2=\epsilon$, where $\epsilon$ is choosen to satisfy our decoherence condition, or $T_{dec}$ defined as the time of the first minima around 0 in Fig.~(\ref{fig:r_plot}). Then varying the difference $q_2-q_1$ rescales time in the above equation, making the decoherence time depend on the energy difference $f$ as,
\begin{equation}
    T_{dec}(f)=\frac{T_{dec}(1)}{f}
\end{equation}
This is to be interpret as $T_{dec}(q_1,q_2)=\frac{T_dec(q_2'=q_1'+1)}{q_2-q_1}$. We see this as meaning that increasing $q_2$ and leaving $q_1$ unchanged re-scales the decoherence time by their difference. 
So the decoherence time depends on the energy scale difference of the 2 interactions and not the energy ratio or something more complex. Fundamentally this is a trivial result, but we got a spectrum $\rightarrow$ decoherence time type of result. We now want to go to more complex cases, not interaction dominated, with non trivial spectrum (not determined by only 1 variable, the difference in energy scale.). Note again that this decoherence time from the spectrum approach neglects the whole idea that the pointer states are actually defined on totally different eigenstates.

\paragraph{About defining the decoherence time: }We suggest using an $\epsilon$ bound on the overlap of the environment states after which we consider decoherence good. Or, as suggested by the form of the the function represented in Fig.~(\ref{fig:r_plot}), we look for the first minimum. 
We note the following useful relations,
\begin{align}
    \sum^n_{k=1}cos(kx)=\frac{1}{2}+\frac{sin(n+\frac{1}{2})x}{2sin(\frac{x}{2})}\\ 
    \sum^n_{k=1}kcos(kx)=\frac{d}{dx}(\sum^n_{k=1}sin(kx))=\frac{d}{dx}(\frac{sin(\frac{nx}{2})sin(\frac{(n+1)x}{2})}{sin(\frac{x}{2})})
\end{align}
This means that we can write the following,
\begin{align}
    |r(t)|^2=\frac{1}{d_2^2}(d_2+2\sum^{d_2}_{k=1}(d_2-k)cos(ktf))\\
    =\frac{1}{d_2^2}(d_2+2d_2\sum^{d_2}_{k=1}cos(kt')-2\sum^{d_2}_{k=1}kcos(kt'))\\
    =\frac{1}{d_2^2}(d_2+2d_2(\frac{1}{2}+\frac{sin(d_2+\frac{1}{2})t'}{2sin(\frac{t'}{2})})-2(\frac{d}{dt'}(\frac{sin(\frac{d_2t'}{2})sin(\frac{(d_2+1)t'}{2})}{sin(\frac{t'}{2})})))\\
\end{align}
where we used $t'=tf$. 
Definning the decoherence time as the first minima, we find it analytically, (see mathematica)


\paragraph{About the relative importance of the terms of this function: }Note that,
\begin{equation}
    \sum^n_{k=1}=\frac{n(n+1)}{2}
\end{equation}
from which we can look at,
\begin{equation}
    \Delta=\frac{d_2(d_2-1)}{2}-\frac{a(a-1)}{2}
\end{equation}
$\Delta$ represents some measure of the error coming from neglecting the $d_2-a$ terms. 
For large $d_2$ and small $a$ (we want to neglect as much as we can), we get,
\begin{equation}
    \Delta\propto \frac{d^2_2}{2}-\frac{a^2}{2}
\end{equation}
This leads to,
\begin{equation}
    a\propto d_2\sqrt{1-\frac{\Delta}{d_2^2}}
\end{equation}
Where we find that taking $\Delta=0$ leads to $a=d_2$, meaning that to get no error, we need to consider the full sum, as expected.
Inverting the formula,
\begin{equation}
    \Delta'=\frac{2\Delta}{d_2^2}=\frac{d_2^2}{2}\sqrt{1-\frac{a^2}{d_2^2}} 
\end{equation}
Defining 
This has $\Delta'$ grows faster closer to $a=d_2$ than $a=0$, which is again an argument that the error is less sensitive to neglecting the small $a$'s.
We can use this formula to get a bound on the error for a certain precision. 
Note, we care about having to put less of the terms in the sum to 0, because they imply havig a lower $T_0$ for the equation. 

\subsection{Schmidt states in the ACL}

\subsubsection{System Schmidt states and GLobal Schimdt states}

Given a system and an environment $\mathcal{S} + \mathcal{E}$ and a pure state defined over both $|\psi(t)\rangle$. It can always be decomposed in its Schmidt basis,
\begin{equation}
    |\psi(t)\rangle = \sum_i \sqrt{p_i(t)}|a_i(t)\rangle|b_i(t)\rangle
\end{equation}
The important points are that the sum is over one index, that the sum is over dimension of the smaller of both systems ($\mathcal{S}$ or $\mathcal{E}$) at most, and that the basis itself depends on the state, which implies that it varies in time.

While $\rho_s(0)$ Eq.~(\ref{eq:rhos0}) can be diagonalized and have only 1 eigenvalue $\lambda=0$, after some time t, we get $\rho_s(t)$ Eq.~(\ref{eq:rhost}) which now has 2 eigenvalues. This is due to the fact that the environment evolves differently for the 2 states in superposition, we get entanglement between the evolving environment and the state of the system. The eigenvectors of this density matrix are the Schmitd states of the system, and take the form,
\begin{align}
    |s_1(t)\rangle = u_1(t)|q_1\rangle + u_2(t)|q_2\rangle\\
    |s_2(t)\rangle = v_1(t)|q_1\rangle + v_2(t)|q_2\rangle\\
    \implies\\
    |q_1\rangle = (\frac{v_2}{\alpha})|s_1\rangle -(\frac{u_2}{\alpha})|s_2\rangle\\
    |q_2\rangle = -(\frac{v_1}{\alpha})|s_1\rangle +(\frac{u_1}{\alpha})|s_2\rangle
    \label{eq:Schmidt_basic}
\end{align}
With $\alpha=(u_1v_2-u_2v_1)$
By unitary evolution our global state stay pure and the Schmidt decomposition tells us that it can always be seen as the superposition of 2 separable states (in this particular bipartide decomposition, and because of the fact that the system has at most 2 non-zero Schmidt values). Going from the time evolution of the global state Eq.~(\ref{eq:time_evo_global}), we can express our $|q_i\rangle$'s from $|s_i\rangle$'s and get the following, 
\begin{align}
    |\psi(t)\rangle = \sqrt{w}|q_1\rangle|\mathcal{E}_1(t)\rangle+\sqrt{1-w}|q_2\rangle|\mathcal{E}_2(t)\rangle \\
    =\frac{1}{\alpha}[|s_1(t)\rangle(\sqrt{w}v_2(t)|\mathcal{E}_1(t)\rangle-\sqrt{1-w}v_1(t)|\mathcal{E}_2(t)\rangle)+|s_2(t)\rangle(-\sqrt{w}u_2(t)t|\mathcal{E}_1(t)\rangle+\sqrt{1-w}u_1(t)|\mathcal{E}_2(t)\rangle)]\\
    =|s_1(t)\rangle|s^{(e)}_1(t)\rangle+|s_2(t)\rangle|s^{(e)}_2(t)\rangle
    \label{eq:se_exp}
\end{align}

We define the following objects as the Schmidt states of our system + environment,
\begin{align*}
    |S_1(t)\rangle = |s_1(t)\rangle|s^{(e)}_1(t)\rangle
    \\
    |S_2(t)\rangle = |s_2(t)\rangle|s^{(e)}_2(t)\rangle
\end{align*}
\paragraph{Getting $|s^{(e)}_i\rangle$: }To find $|s^{(e)}_i\rangle$ we can find $A_i$, $u_i$, $v_i$ and $|\mathcal{E}_i\rangle$ and use them to express it. Diagonalize $\rho_s$ and $\rho_e$, find their eigenvector and associate them to each other by matching their eigenvalue. Or we can do the following (which is implemeted numerically.)\\

To find $|s^{(e)}_i(t)\rangle$, we consider $P_i|\psi(t)\rangle$, with $P_i(t)=|s_i(t)\rangle\langle s_i(t)|$ using the orthogonality $\langle s_1|s_2 \rangle=0$. And finding the first nonzero term in $|s_i(t)\rangle$ we isolate the vector $|s^{(e)}_i(t)\rangle$. \\ 

\subsubsection{Decoherence induces convergence of global Schmidt to global pointer states}

\paragraph{The basic idea is the following:}

\begin{itemize}
    \item \textbf{Schmidt states} are the eigenstates of $\rho_s$
    \item \textbf{Pointer states} are states of the system such that entanglement between them and the environment does not grow with time.
    \item Decoherence causes $\rho_s$ to become diagonal in the pointer basis
\end{itemize}
Taking all 3 points together, it is obvious that the Schmidt states of the system converge to its pointer states. \\

What about the global forms of the Schmidt and Pointer states? They are both extended to their global definition in the following way,
\begin{align}
    |\psi(t)\rangle = |s_1(t)\rangle|s_1^{(e)}(t)\rangle+|s_2(t)\rangle|s_2^{(e)}(t)\rangle = |S_1(t)\rangle+|S_2(t)\rangle\\
    |\psi(t)\rangle = |p_1\rangle|p_1^{(e)}(t)\rangle+|p_2\rangle|p_2^{(e)}(t)\rangle = |P_1(t)\rangle+|P_2(t)\rangle
\end{align}
At time $t'>T_{dec}$, decoherence diagonalizes the system density matrix in the pointer basis, meaning $|s_i(t')\rangle=|p_i\rangle=cst$. This also implies equality between our global Schmidts and pointers at the time, 
\begin{align}
    |\psi(t')\rangle = |s_1(t')\rangle|s_1^{(e)}(t')\rangle+|s_2(t')\rangle|s_2^{(e)}(t')\rangle = |p_1\rangle|s_1^{(e)}(t')\rangle+|p_2\rangle|s_2^{(e)}(t')\rangle\\
    =|p_1\rangle|p_1^{(e)}(t')\rangle+|p_2\rangle|p_2^{(e)}(t')\rangle\\
    \implies |s_i^{(e)}(t')\rangle = |p_i^{(e)}(t')\rangle\\
    \implies |S_i(t')\rangle = |P_i(t')\rangle
\end{align}
Note that our global pointer states varies, while our system one is constant. 

This is quite obvious, but it means that worlds (if they are our global pointer states) split the total energy eigenspace when the pointer states do. The question becomes, when do the global pointer states do so? 

The definition of being a global pointer state is to stay separable + have the system part be a system pointer state.
Staying separable means having an evolution of the form, 
\begin{equation}
    |P(t)\rangle=|p\rangle|p^{(e)(t)}\rangle
\end{equation}
TODO What does this imply mathematically? condition on separability of basis? Condition on Hamiltonian?

\paragraph{To see it more mathematically:} we explain how $|S_i\rangle\approx|p_i\rangle$ for post-decoherence times. Note that the pointer states are defined by their weights in the total energy eigenbasis, the phase associated to each weight is not important to their property of staying separable.

\paragraph{Potential confusion:} Our global pointer states are states that are separable according to our bipartide system+environment separation, but this also seems to match out global Schmidt states, which are also separable by definition. The thing to keep in mind is that Pointer states are stable in their separability, while if we froze our Schmidt state at a certain time and evolved it in time, we would have that the separability doesn't last. (TODO add graphs showing that.)



By the form of pointer states being $|q_j\rangle|\text{any environment state}\rangle$, we can show that the Schmidt states converge to pointer states simply by showing $|s_i\rangle\rightarrow a_i|q_j\rangle$. This mean that we dont actually care about the form of $|s^{(e)}_i\rangle$ of Eq.~(\ref{eq:se_exp}) and all we are asking is that either $|u_1(t)|$ or $|u_2(t)|$ tends to 0. And vice versa for $v$. This is equivalent to showing that the off

We start at $|u_1(0)|=\frac{1}{\sqrt{w}}$ and $|u_2(0)|=\frac{1}{\sqrt{1-w}}$. 

We construct $\rho_s(t)$ from its Schmidt form, and express it in the $\{|q_i\rangle\}$ basis
\begin{equation}
    =\begin{pmatrix}
        0 & ... & & ... & 0 \\
        ... & |u_1|^2+|v_1|^2+u_1v_1^*+v_1u_1^* & ... & u_1u_2^*+v_1v_2^*+u_1v_2^*+v_1u_2^* & ... \\
        ... & 0 & ... & 0 & ... \\
        ... & u_2u_1^*+v_2v_1^*+u_2v_1^*+v_2u_1^* & ... & |u_2|^2+|v_2|^2+u_2v_2^*+v_2u_2^* & ... \\
        0 & ... & & ... & 0 \\
    \end{pmatrix}
    \label{eq:rhos_schmidt}
\end{equation}
Matching eq.~(\ref{eq:rhos_schmidt}) and Eq.~(\ref{eq:rhost}), we find the following equalities,
\begin{align*}
    |u_1|^2+|v_1|^2+u_1v_1^*+v_1u_1^* = w\\
    |u_2|^2+|v_2|^2+u_2v_2^*+v_2u_2^* = 1-w\\
    u_1u_2^*+v_1v_2^*+u_1v_2^*+v_1u_2^* = \sqrt{w-w^2}\langle\mathcal{E}_1(t)|\mathcal{E}_2(t)\rangle\\
    u_2u_1^*+v_2v_1^*+u_2v_1^*+v_2u_1^* = \sqrt{w-w^2}\langle \mathcal{E}_2(t)|\mathcal{E}_1(t)\rangle\\
\end{align*}

At a time $T_{dec}$, we have $\langle \mathcal{E}_1(T_{dec})|\mathcal{E}_2(T_{dec})\rangle\approx0$. Then we have solution to this system of equation $u_2=v_1=0$ and $u_1=\sqrt{w}$ $v_2=\sqrt{1-w}$ makes the equations work. It becomes the only solution if we add the 2 conditions $|u_1|+|u_2|=|v_1|+|v_2|=1$ and impose no phases to $u_1$ and $v_2$  (8 eqs for 8 unknowns.). (TODO prove that)\\

We thus conclude that the global Schmidt states converge to global pointer states due to decoherence. For $t\geq T_{dec}$,
\begin{align*}
    |S_1(t)\rangle = |s_1(t)\rangle|s^{(e)}_1(t)\rangle\\
    =|q_1\rangle|\mathcal{E}_1(t)\rangle
    \\
    |S_2(t)\rangle = |s_2(t)\rangle|s^{(e)}_2(t)\rangle\\
    =|q_2\rangle|\mathcal{E}_2(t)\rangle
\end{align*}

This can be trivially summarized to: Schmidt states converge to pointer states because pointer states are the stable eigenstates of the density matrix post decoherence, meaning the Schmidt states (eigenstates of the density matrix) will naturally converge to pointer states by decoherence. The fact that our global Schmidt and pointer states follow the same rule comes from the way that the environment part of theses global states is found. 


\subsection{To deal with....}


We can, in general terms take our unitary evolution as,
\begin{equation}
    U(t)=\sum_j|a_j\rangle\langle a_j|\otimes U^{\mathcal{E}}_j(t)
\end{equation}
Starting the system in $|b\rangle$, then $U_j^{\mathcal{E}}|b>=|b_j(t)\rangle$. This means that the reduced density matrix of the system $\mathcal{S}$, evovlves as,
\begin{equation}
    \rho_{ij} = \langle b_i(t)|b_i(t)\rangle \rho_{ij}(0)
\end{equation}
This results in the evolution of the system density matrix to a diagonal form. This diagonal form, explains the apparent classicality of the unique measurement result. The 2 results, after some decoherence time, belong to 2 different orthogonal states. 


Decoherence has it that $\langle b_j(t)|b_i(t)\rangle\rightarrow \delta_{ij}$ for $t\rightarrow \infty$. 



Exaplain how A(t) goes from 1 to not 1. 





In practice, the Hilbert space in which the pointer states are defined is $d_2$ dimensional and is $\{|q_1\rangle|v_k\rangle\}$ and $\{|q_2\rangle|v_k\rangle\}$ respectively. We can also individually look at the spectrum of $E_Iq_iH_r'$, which for $i=1$ corresponds to a thin distribution in the energy spectrum, like the blue spectrum in Fig.~(\ref{fig:dis_in_HI}). For $i=2$ it corresponds to one of the wide spectrums of Fig.~(\ref{fig:dis_in_HI}). So Schmidt states converging to pointer states should be visible in their distribution in the interaction energy eigenbasis.

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/HI_distrib_early.png}
    \label{fig:1}
    \caption{Distribution before decoherence}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/HI_distrib_late.png}
    \label{fig:2}
    \caption{Distribution after decoherence}
  \end{subfigure}
  \caption{}
  \label{fig:dist_EI_dep}
  \caption{Freeze frame on the distribution of a Schmidt state in the energy eigenbasis of $H_I$ before and after decoherence. We see the distribution converge to that of a pointer state.}
\end{figure}


TODO explain convergence of Schmidt states to pointer states by some perturbation theory. 

This also has deep ramifications. Our Schmidt states converge to living in totally orthogonal subspaces of the Hilbert space. This is visible by the fact that the Schmidt states converge to pointer states. And that theses pointer states can be looked at in the $H_I$ eigenbasis, and they do not share a no-zero term in this basis.

The quantum states of 

!!!!!
this is a super particular case where the system states define the first term in the total energy eigenbasis. 
!!!!



=====
We use Schmidt states as our object of study, since they are known to converge to Pointer states, which are an attempt at defining classical Branches of the wavefunction.




\begin{figure}[h]
    \centering
    \includegraphics[scale=0.5]{Figures/Wigner_sum.png}
    \caption{The set of wigner semi-circles who's sum gives us the spectrum of $H_I$. The wider ones are for higher $q_i$'s.}
    \label{fig:wigner_sum}
\end{figure}

\begin{comment}
    

Then,
\begin{equation}
    H|\psi(0)\rangle=|q_1\rangle(\frac{2+q_1}{\sqrt{w}})\sum_jc_j|e_j\rangle+|q_2\rangle(\frac{2+q_2}{\sqrt{1-w}})\sum_jc_j'|e_j\rangle
\end{equation}
or more generally,
\begin{equation}
    |\psi(t)\rangle=|q_1\rangle(\frac{2+q_1}{\sqrt{w}})\sum_jc_j|e_j\rangle+|q_2\rangle(\frac{2+q_2}{\sqrt{1-w}})\sum_jc_j'|e_j\rangle
\end{equation}

which is no longer separable, and by its factorizability by $|q_1\rangle$ and $|q_2\rangle$, we understand that for all $t$,
\begin{equation}
    |\psi(t)\rangle=\frac{1}{\sqrt{N}}(s_1|q_1\rangle|E_1(t)\rangle+s_2|q_2\rangle|E_2(t)\rangle)
\end{equation}
This means that the Schmidt decomposition of our system+env always has 2 nonzeros schmidt weights at most. But this decomposition (ie in terms of 2 states $|q_i\rangle |E_j\rangle$) is not immediately the 2 schmidt states. Indeed, Schmidt 1 starts up as $|\psi\rangle$ and evolves to something with most of its weight in a factor in from of $|q_1\rangle|E_1\rangle$. But of note, our pure state starts with nonzero value in 200+200 total eigenstates, the Schmidt states share theses with each other, 200 each. (Need to do a part where we look closer at evolution, see black board image.)

Note, $|E_i\rangle=\sum_jc_{ji}(t)|e_j\rangle$.
\end{comment}

\begin{comment}
Note that the weight in from of both states are equal if,
    \begin{equation}
        q_1=2(\frac{\sqrt{w}}{\sqrt{1-w}}-1)+q_2\frac{\sqrt{w}}{\sqrt{1-w}}
    \end{equation}
\end{comment}



\subsection{Perturbation theory}

Need to figure out what I am looking for...

perturbation theory to figure out the spectrum? Yes
Perturbation theory to explain the convergence? No need
Pertubration theory to find an effective Hamiltonian?

The perturbation is as a function of EI.
A little weird because q1*EI is not really at a smaller scale than the other hamiltonian.

The point of the Caldeira-Leggett model is to study the intermediate regime of measurement $H_s\approx H_I$. So i do not think I can do a perturbation theory on the interaction energy

\subsection{Ramification of sharing the total energy eigenstate}
The branches of the wavefunction loose access to half of the energy eigenbasis. 
Implication about loss of access to some dimension of the Hilbert space? 
This is the very special case where the total energy basis states can be written a product states of the system energy basis states and some environment state, AND there being no self interaction of the system.
But this begs the question. Everytime we are able to define a measurement with this model, then the dimension of our accessible Hilbert space in the totla energy eigenbasis is halfed? (Simple example of no self interaction superposition of state, 2 photons in a cavity.) \\
Note that post decoherence the branches have a different effective Hamiltonian, ie one made of the sum of 2 block diagonal terms (one of the block diagonal si different for diff branches). So the total Hamiltonian wrt which you loose access to part of the Hilbert space changes after each measurement. This I think, makes the continuous loss of Hilbert space narrative no longer true. 

$H_{tot,1}\rightarrow$ branching of state defined over $2*d_2$ energy eigenstates of $H_{tot}$ leads to 2 worlds $|p_1\rangle$ and $|p_2\rangle$  defined over $d_1$ eigenstates of $H_{tot}$ and evolving under 



\subsection{Worlds}

Pointer states as worlds? Because for now I underdtand it as such, and use it as such in this paper.
See paper saying no.


\subsection{Explaining the energy splitting}

We need to explain why worlds do not share energy eigenstaes. ie, why the amplitudes of the state in an energy eigenstate is fully given to a world and not shared. Indeed, if we only ask that worlds be orthogonal states, we get that there are ways to do this without sharing the energy eigenstates.

Very generally we can define worlds as, (TODO IS THAT REALLY APT? ARE WORLDS STATICALLY DEFINED AS A SUM OF CONSTANT TERMS IN THE TOTAL ENERGY EIGENBASIS?)
\begin{equation}
    |w_i(t)\rangle=\sum_{k\in O_i}c_ke^{e^{-itE_k}}|k\rangle
\end{equation}
$O_i$ defines the set of total hamiltonian eigenstates in which world $i$ is defined. If we take that we have 2 worlds and that they share an energy eigenstate ($j$), then the overlap is constant and worth $\langle w_1|w_2\rangle(t)=|c_j|^2$. If we have that the overlap is in n eigenstates, it is still constant. Basically, the only way for our worlds to not have an overlap is that they do not share an energy eigenbasis. 

\subsubsection{Note on the branching event and why we look at Schmidt states}

For an global state,
\begin{equation}
    |\psi(t)\rangle\sum_ku_ke^{-itE_k}|k\rangle
\end{equation}
we can always extract from this orthogonal worlds 2 pointer states that do not mix, and stay orthogonal. ie there is not visible branching event to be found by just looking at the global state like this. 

Thus we look at SChmidt states. TODO detail more why Schmidt states are legitimate objects to look at to witness decoherence. other than being states the converge to objects with world like properties at the rate of decoherence (pointer states).


The explanation 


\subsection{Characterizing the probability distribution of the global state}

The state, and Schmidts are define as non-zero on only part of the energy eigenspace because of our model. The Hamiltonian has random matrices acting on only the environment subspace, and no self interaction for the system. By starting and staying defined over 2 out of 10 energy eigenstates of the system, the global state is always defined over 1/5th the space (for $d_1=10$). Is that important at all? \\

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/dist_EI0.png}
    \label{fig:1}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/dist_EI_not_0.png}
    \label{fig:2}
  \end{subfigure}
  \caption{}
  \label{fig:dist_EI_dep}
\end{figure}

\paragraph{Impact of $E_I$: }Varying $E_I$ changes the total energy eigenbasis. Taking $E_I=0$ we have as expected a delta, as the environment starts and stays as a total energy eigenstate. As we vary $E_I$, it takes a bell shape and its standard deviation rises. See Fig.~(\ref{fig:dist_EI_dep}), which shows us how an $H_e$ eigenstate is defined in the eigenbasis of $H_e+H_e'$. 

\paragraph{Impact of $w$: }It is a factor in front of the 2 branches, so changes the relative importance of each branches when we vary it.

\section{Does Branching dynamics split the energy eigenspace between the branches in a particular way?}
This question is motivated by the behavior of $Neff_{schmidt,i}/Neff_{total}=\delta_i$, with $Neff_{state}=\frac{1}{\sum_ip_i^2}$, $p_i$ the probability of finding the state we are considering in total energy eigenstate $i$. See Fig.~(\ref{fig:Neff_andy}). The idea of $Neff$ being to measure the spread of the Schmidts over the energy eigenspace. Neff is maximized by a uniform distribution and minimized by $p_i=1\text{ for }i=a$ for some integer $a$. $\delta_i$ is going to depend on how the distribution of Schmidt $i$ evolves in the energy eigenspace, which is what we want to study.

\begin{figure}[h]
    \centering
    \includegraphics[scale = 0.4]{Figures/Neff_andy.png}
    \caption{In this specific run, the curves join and stay together. With different parameters, we see the 2 curves stabilize with some distance, positive or negative}
    \label{fig:Neff_andy}
\end{figure}

What we saw looking at the graphs for multiple runs of the simulation with varied parameters, is that sometimes both $\delta_i$'s would match up, sometimes after decoherence $\delta_1>\delta_2$ or $\delta_2>\delta_1$.

It would be interesting to characterize $Neff$ to understand its behavior. Are there necessary conditions for the convergence of the 2 curves? Why does Neff have different behaviors for different $E_I$, $w$ or the initial environment state? 

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.4]{Figures/Neff_chara2.png}
    \caption{Graphs of $\delta$ for varying parameters $E_I$ and $w$. Top left $w=0.1, E_I=0.03$, $\rightarrow$ rising $E_I$, $\downarrow$ rising $w$.}
    \label{fig:characteriazation_Neff}
\end{figure}


We see in Fig.~(\ref{fig:characteriazation_Neff}) that $\delta_1$ always starts at 1 since it is the global state at $t=0$. It then varies a little from its base value to some equilibrium value slightly above or under 1. The fact that $\delta_1$ barely varies comes from the fact that the shape of the distribution of Schmidt 1 also barely varies. $\delta_2$ varies (from initial to equilibrium) by a factor from 10 to 100.

\subsection{Other hints that eigenspace is shared in an interesting way}

Looking at the difference between how things are a little after interaction starts and after all has settled, Fig.~(\ref{fig:gif_compare}) we see that the Schmidt states seem to have shared the energy eigenspace.

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/g_1.png}
    \caption{Zoomed view of the probability distribution of Schmidt 1 and 2 in the total energy eigenbasis at frame 11/100}
    \label{fig:1}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/g_2.png}
    \caption{Zoomed view of the probability distribution of Schmidt 1 and 2 in the total energy eigenbasis at frame 89/100}
    \label{fig:2}
  \end{subfigure}
  \caption{There is less large probability overlap at frame 89 than 11}
  \label{fig:gif_compare}
\end{figure}

\subsection{Are probabilities not just shared following a conservation law?}
Since we have unitary evolution, wont the probability of being in an energy eigenstate for both Schmidt states just sum up to what it is for the global state? They wont because of interferences.

At some time t:
$$|\psi\rangle=\sqrt{s_0}|q_1\rangle|E_1\rangle>+\sqrt{s1}|q_2\rangle|E_2\rangle$$

Taking a total energy eigenstate $|Ai\rangle$

The probability that the state be in this energy eigenstate is 
$$P(|\psi\rangle \text{ in } |A_i\rangle)=|\langle A_i|\psi\rangle|^2 = s_0|\langle A_i|q_1E_1\rangle|^2+s1|\langle A_i|q_2E_2\rangle|^2+\sqrt{s0s1}(\langle A_i|q_1E_1\rangle^*+\langle A_i|q_2E_2\rangle^*)$$

This can also be written,
$$P(|\psi\rangle \text{ in } |A_i\rangle)= s_0P(|Schmidt_1\rangle\text{ in }|A_i\rangle)+ s_1P(|Schmidt_2\rangle\text{ in }|A_i\rangle) +\sqrt{s0s1}(\langle A_i|q_1E_1\rangle^*+\langle A_i|q_2E_2\rangle^*)$$
Where the leftover are quantum interference terms.
Interestingly, $\sqrt{s_0s_1}$ is maximal for $s_0=s_1$ at maximal entanglement, which goes against at least my intuition that the  worlds are supposed to be at maximal non-interference then.

We can visualize this interference in Fig.~(\ref{fig:interf1002}) and Fig.~(\ref{fig:total_interference}).
\begin{figure}[h]
    \centering
    \includegraphics[scale = 0.5]{Figures/Interference_1002.png}
    \caption{In this plot we see the importance of interference effects for the value of probability that a Schmidt has to be in an energy eigenstate. (Chosen for its high interference.)}
    \label{fig:interf1002}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[scale = 0.5]{Figures/total_interf.png}
    \caption{Graph of the total interference between Schmidt states}
    \label{fig:total_interference}
\end{figure}

\newpage

\subsection{Other metrics to describe the sharing of eigenspace}
We want to confirm that there is indeed interesting dynamics to find in the sharing of energy eigenspace + we want the right tool to characterize it.

\paragraph{Mean and standard deviation}
To characterize the shape of the distributions, we look at the variation of the mean and standard deviation of both distributions in time. The question is "How do the shapes of the distributions evolve in time?"
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.4]{Figures/mean_sdrd.png}
    \caption{Graphs of the means and standard deviations of the probability distributions of Schmidt 1 and 2 for parameters $E_I=[0.05,0.06,0.07,0.08]$ and $w$ = [0.2,0.25,0.3,0.35].$\rightarrow$ rising $E_I$, $\downarrow$ rising $w$.}
    \label{fig:characteriazation_mean_stdr}
\end{figure}

What this confirms is that the shape of the distribution of Schmidt 1 varies little in time, while Schmidt 2 varies much at the beginning.

\paragraph{Overlap of the probability distributions}
The overlap is the projected value of the square root of the probability vectors of Schmidt 1 and 2 with themselves and with the global state. The question investigated is "Are Schmidt 1 and 2 defined over the same eigenbasis?". In more detail, they are of course defined in the same Hilbert space, but do they both have high probability in the same eigenbasis? 
\begin{figure}[h]
    \centering
    \includegraphics[scale=0.4]{Figures/overlap_characterize.png}
    \caption{Graphs of the overlap of the probability distributions of the Schmidt states and the global state. Parameters $w=[0.1,0.2,0.3,0.4], EI=[0.03,0.05,0.07,0.09]$. $\rightarrow$ rising $E_I$, $\downarrow$ rising $w$.}
    \label{fig:characteriazation_overlap}
\end{figure}
The green curve, shows that the Schmidt states start by becoming similar likely as Schmidt 2 catch's up quickly to the shape it is supposed to have, but then give way to each other, do not overlap much in the energy eigenbasis. {\color{teal} The distributions evolve to similar shapes, but do not occupy the same eigenstates.}


\paragraph{Occupation of the Hilbert space}
For the occupation measure of the Hilbert space, we count the number of total energy eigenstates in which Schmidts have probability above a threshold $\epsilon$. {\color{teal}The question investigated is, "Does Schmidt 1 gives some of its space to Schmidt 2?". No}. All we see, is that no the number of eigenbasis states "occupied" by Schmidt 1 does not really change. And for Schmidt 2 we see the expected behavior, knowing that it goes from a uniform distribution to a more concentrated one. \ref{fig:characteriazation_occupation}

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.4]{Figures/occupation_charact.png}
    \caption{Graphs of the occupation of Hilbert space by Schmidt 1 and 2 ($\epsilon=0.001$).Parameters $w=[0.1,0.2,0.3,0.4], EI=[0.03,0.05,0.07,0.09]$. $\rightarrow$ rising $E_I$, $\downarrow$ rising $w$.}
    \label{fig:characteriazation_occupation}
\end{figure}

\paragraph{Gifs}
Gifs of how the distributions of both Schmidts changes in time. Cannot put them in a pdf but we can discuss them here.

The distribution of Schmidt 1 starts as the distribution of the global state. As the second Schmidt value goes from 0 to not 0, Schmidt 2 gains in importance, it takes over some of the energy eigenstates on which Schmidt 1 is defined and takes a similar shape. So we have 2 distributions of the same shape but not defined over the same space.

\subsubsection{General characterization of these metrics}

\paragraph{Interference and $w$}
We generally see these metrics vary in unison with the amount of interference between Schmidt 1 and 2. We also note an inversion in behavior at equilibrium for a change of w to 1-w. As an example of this law, is the plots of occupation with w=0.03 and 0.07 (which also have underneath the plots of interference, and we clearly see the same shape.) \ref{fig:Occup_interf}

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/occup_interf1.png}
    \label{fig:1}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/occupe_interf2.png}
    \label{fig:2}
  \end{subfigure}
  \caption{We see that the occupation number varies with total interference. We also see that we have an inversion of equilibrium behavior for w=0.3 and w=0.7}
  \label{fig:Occup_interf}
\end{figure}
{\color{teal} Interference makes sense of the common behavior.}\\
{\color{teal} Inverting w the probability, inverts teh equilibrium behavior. }


\paragraph{General solution}
The weight in front of both states are equal if,
\begin{equation}
    q_1=2(\frac{\sqrt{w}}{\sqrt{1-w}}-1)+q_2\frac{\sqrt{w}}{\sqrt{1-w}}
\end{equation}
Then,
\begin{equation}
    |\psi(t)\rangle=|q_1\rangle(A)\sum_jc_j(t)|e_j\rangle+|q_2\rangle(A)\sum_jc_j'(t)|e_j\rangle
\end{equation}
We can make that happen while keeping $E_I$ and $w$ invariant by changing either the energy between the eigenstates of the SHO, or the states we choose for the superposition (which is what we do in practice). {\color{teal}The idea being that we eliminated the asymmetry between the 2 Schmidt states, which makes $\delta_{1}$ and $\delta_2$ behave the same at equilibrium (as well as other metrics).}\\

We verify this by making a plot of $\delta$ where the curves converge and another where they are inversed while keeping $w=0.41$ and $E_I=0.06$, typically values where we get distinct equilibrium behaviors for Schmidt 1 and 2.

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/Neff_perfect_match_2.png}
    \caption{For weight difference of 0.01}
    \label{fig:1}
  \end{subfigure}
  \begin{subfigure}[b]{0.4\linewidth}
    \includegraphics[width=\linewidth]{Figures/g_2.png}
    \caption{For a weight difference of 10}
    \label{fig:2}
  \end{subfigure}
  \caption{We see a that by making Schmidt 1 and 2 as "important" we can get them to agree on Neff. And we see the opposite happen when we maximize their weight difference.}
  \label{fig:gif_compare_weight}
\end{figure}

{\color{teal} See notebook "The same"}\\
\subsection{Conclusion:}
{\color{teal} The "energy" of the superimposed states, and their probability (in our case $q_1,q_2,w,(w-1)$) has an impact on the distributions of Schmidts in the energy eigenbasis.}

%{\color{teal} I am still not fully convinced there is "something" to the sharing of energy eigenspace.}

\subsection{Pseudo pointer in the interaction spectrum}

We find an interesting evolution of the distribution in this basis. See Fig.~(\ref{fig:dis_in_HI}). The motivation for looking in this basis was to look for pointer like behavior of converging towards an energy eigenstate of $H_I$. We see that it has a behavior like that, only not so complet.

\begin{figure}
    \centering
    \includegraphics[scale = 0.3]{Figures/dist_in_HI.png}
    \caption{The distribution of Schmidts has the possibility under certain conditions of going from uniformly distributed to ending and staying in this distribution.}
    \label{fig:dis_in_HI}
\end{figure}

\subsubsection{Characterizing the behavior of the distributions in the interaction energy basis.}


env does not matter



characterize behavior to see if it is weight dependant. 
interestingly you can get both to do so by macthing the weihghts. can you get neither to do so?

We look back at the equation,
\begin{equation}
    |\psi(t)\rangle=|q_1\rangle(\frac{2+q_1}{\sqrt{w}})\sum_jc_j(t)|e_j\rangle+|q_2\rangle(\frac{2+q_2}{\sqrt{1-w}})\sum_jc_j(t)'|e_j\rangle
\end{equation}

We have that the eigenstates of $H_e$ are $\{|e_i\rangle\}$, the eigenstates of $H_I$ are $\{|q_i\rangle|A_j\rangle\}$ We can re-write $ |e_j\rangle= \sum_ka_{kj}|A_k\rangle$, meaning,
\begin{equation}
    |\psi(t)\rangle=|q_1\rangle(\frac{2+q_1}{\sqrt{w}})\sum_{jk}c_j(t)a_{kj}|A_k\rangle+|q_2\rangle(\frac{2+q_2}{\sqrt{1-w}})\sum_{jk}c_j(t)'a_{kj}|A_k\rangle
\end{equation}

Which leads to ,
\begin{equation}
    P(|s_2(t)\rangle \text{ is in } |A_l\rangle) = |\frac{2+q_2}{\sqrt{1-w}}\sum_{jk}c_j'(t)a_{kj}\delta_{lk}|^2 = |\frac{2+q_2}{\sqrt{1-w}}|^2|\sum_{jl}c_j'(t)a_{lj}|^2
\end{equation}
Somehow, we have that $|\sum_{jl}c_j'(t)a_{lj}|^2$ is suppressed for a certain set of $l$'s. The $l$'s that correspind to outside the bounds we can see in Fig.~(\ref{fig:dis_in_HI}). To study this, we need to understand the time evolution of the $c_j(t)$'s.

This is not explained by our numerical or model (at least trivially), since we do see that in principle the $a_{lj}$'s are not zero.

What could explain the supression? Not interferences. For multiple reasons. interferences go to 0 on the out


We would like to see how it evolves in the basis of $H_I$

To do that theoretically, we would need to Haussdorf approximate out unitary of non-commuting op.


\newpage


\section{Why do they share the energy eigenstates in this way?}
 
%Is there some comparison to a case of two boxes of gas with the same pressure and temperature but totally distinct microscopic form?

What explains this way of sharing the eigenspace? Interferences between Schmidt states? \\

{\color{teal} Do the probabilities in individual eigenstates vary less once equilibrium is reached? Do near zeros stay at near zero? Could it be that they spread in the eigenbasis and since they dont have many high probabilities, they dont overlap meaningfully simply by chance?}

\section{Can we get it all from the energy spectrum and the distribution of the global state in it?}

Energy spectrum + state defined in energy basis -> sharing of Hilbert space by worlds -> explain the phenomenas we observed

%Properties are shared like "this" because the spectrum is like "that"

Can we get the decoherence time from the spectrum?

\subsection{Getting decoherence time from the spectrum}

Note on getting things from the spectrum.... the decoherence time should be essentially defined by how fast we can consider the phases in front of the decomposition of $|\mathcal{E}_1(t)\rangle$ and $|\mathcal{E}_2(t)\rangle$ in $|k\rangle$, independent/randomised. $|\mathcal{E}_1(t)\rangle$ and $|\mathcal{E}_2(t)\rangle$ evolve according to $H_e^{(1)}$ and $H_e^{(2)}$ which have different spectrum. it might be possible to estimate from the spectrum distribution the time after which the relative phase of both vectors (compared in a common basis) look randomly selected, at which point we would have decoherence. Note that I need to prove that this is sufficient for decoherence. There is also a complication, which is that there is no common eigenbasis for $H_e^{(1)}$ and $H_e^{(2)}$. But it should be easy to look at in the $H_I$ dominated limit.

\subsubsection{$H_I$ dominated limit}
In this limit $H_e^{(1)}=E_Iq_1H_r$ and $H_e^{(2)}=E_Iq_2H_r$, meaning that they have a common eigenbasis. Taking this common eigenbasis to be $|k\rangle$, it means that we have,
\begin{align}
    |\mathcal{E}_1(t)\rangle=\frac{1}{\sqrt{d_2}}\sum_ke^{-itE_k}|k\rangle\\
    |\mathcal{E}_2(t)\rangle=\frac{1}{\sqrt{d_2}}\sum_ke^{-itE_k'}|k\rangle
\end{align}
Since both environment states start in the same state, they have the same amplitudes in any basis. We simplify the problem by taking that amplitudes to be uniform in the basis we consider. The differentiation between both states then only comes from the phases. 

The spectrum of $H_e^{(1)}$ and $H_e^{(2)}$ are simply different by a factor of $\frac{q_2}{q_1}=f$.





\section{Other}

\subsubsection{Condition on there being an energy splitting}

Bsically, if we have a Hamiltonian that can be split as the tensor product of a diagonal matrix and a complex Hamiltonian, and that in the same bassi have the state of the universe be a superposition product some random state, we will get this splitting happening. TODO specify better the conditions for the splitting happening, and look into if that is a common condition? if we go from a hamiltonian that has that, do the world afterwards and the effective hamltonians they live in also have that?

\subsubsection{More on pointer states}

Pointer states are states selected by the predictability sieve, which selects states of the system which deteriorate the least into mixtures over time. (or stay separable if we consider the global state.) By this condition, they are the state with the highest degree of reversibility in the system, whiich is a property of classical systems. (no growing entropy associated to reversibility). Fundamentally, we justify looking at global pointer states because they are defiend by properties we ask of classical worlds. Can we get an useful defintion of worlds by developing our thinking on pointer states? \\

We ask of a world to be separable into many classical subsystems. This can be translated into the following condition. Choosing a scale $d$ (ie number of dimension of Hilbert space above which we consider a system classical), and a subdivision of the Hilbert space $\mathcal{H}=\mathcal{H}_1\otimes ...\otimes \mathcal{H}_n$, with each $\mathcal{H}_i$ has dimension $d$ we can alternatively consider each Hilbert space $\mathcal{H}_i$ as a subsystem, in which the state is a pointer state einselected by the rest of the Hilbert space. Furthermore, the evolution of the global state is separated (meaning you can see it like an operator phase in front of both term in the separable state). This must be true for all sub-system, meaning that there is a global pointer state basis in which the global state can be written like this, 
\begin{align}
    |w\rangle=|\psi_1\rangle\otimes|\psi_2\rangle\otimes...\otimes|\psi_n\rangle\\
    |w(t)\rangle=e^{-itH_1}|\psi_1\rangle\otimes e^{-itH_2}|\psi_2\rangle\otimes...\otimes e^{-itH_n}|\psi_n\rangle
\end{align}
If we go back to the table analogy and the subsystems as pieces of the table big enough to be considered classical, then we note that there are different ways to cut a table up in chunks of set size. That is we also need to consider $\mathcal{H}=\mathcal{H}_{1'}\otimes ...\otimes \mathcal{H}_{n'}\neq\mathcal{H}_1\otimes ...\otimes \mathcal{H}_n$. And the conclusion is that we also need our world to have a global pointer state basis in which the world can be written,
\begin{align}
    |w\rangle=|\psi_1'\rangle\otimes|\psi_2'\rangle\otimes...\otimes|\psi_n'\rangle\\
    |w(t)\rangle=e^{-itH_1'}|\psi_1'\rangle\otimes e^{-itH_2'}|\psi_2'\rangle\otimes...\otimes e^{-itH_n'}|\psi_n'\rangle
\end{align}
This imposes a condition on $|\psi\rangle$ and $H_{tot}$. What is that condition? is it that the world is separable in any possible subdivision of the Hilbert space? I dont know....\\

What has been discussed here is true for local subdivisions (pieces of table I can hold in my hands), but what if we consider $\mathcal{H}=\mathcal{H}_{1''}\otimes ...\otimes \mathcal{H}_{n''}$ a non-local decomposition of the Hilbert space.     

the simple idea being that a table can be cut down in many "classical" pieces in many ways. The basic question is: What happens when I consider global pointer states defined by being product state of pointer states of many subsystems. And do I get anything else from asking for a variable decomposition (setting maybe the size of the subsytems to be classical). 

\subsection{Why do we get no overlape?}
World overlape in the total energy eigenbasis. We defien our 2 worlds as $|w_1\rangle(t)=\sum_kc_ke^{-ite_k}|k\rangle$ and $|w_1\rangle=\sum_kc_k'e^{-ite_k}|k\rangle$. 
Then their overlap is,
\begin{equation}
    \langle w_1|w_2 \rangle(t) = \sum_{k}c_k^*c_k'
\end{equation}
Note that the time dependance of the worlds is such that there is time independance of their overlap.\\

With only 1 eigenstate where the worlds are non-zero together, they have nonzero overlap $\langle w_1|w_2 \rangle(t)=cst=c_i^*c_i'$. With more than one such eigenstate there exists a possible balance. ie, $\langle w_1|w_2 \rangle(t)=\sum_{i\in nz}c_i^*c_i'=0$ is possible. 





\subsection{What does it imply?}

If the worlds are truly defined in different eigenstate of the total energy eigenbasis, what are the implications? Do we loose most of the space after each measurement? 

What are the conditions for such measurement events happening? We need a Hamiltonian that can be decomposed in the form of the ACL model,.... what exactly is needed to reproduce theses effects... 
+ condition that in this basis the state can be written in the manner we specify at the beginning. (I can work in the general case.) 

Can there be an integrability condition for the Hamiltonian having this level of separability? 

Anyways, once you have this Hamiltonian, you can imagine

\subsubsection{Confusion regarding the loss of dimension}

The state of the worlds are themselves defined in less dimensions, ie using less numbers in the total energy eigenbasis. Is that recoverable? Do they keep on loosing more? 
My confusion comes from the fact that $|0\rangle=\frac{|0\rangle}{2}+|1\rangle+\frac{|0\rangle}{2}|1\rangle=|+\rangle+|-\rangle$. and if somehow $|\pm\rangle$ happened to be the worlds post another measurement, then theses worlds have recovered 1 dimension... 
But I think, the point is mostly that my world is defined in 1 dim (here) but also only time evolves according to a Hamiltonian that is a scalar, which is incapable of creating worlds defined in more dimensions.




\paragraph{Measure of fluctuation in time of the distributions}
Similarity in time, a sort of measure of fluctuation. Maybe useful to characterize the behaviors of s1 and s2 distribution themselves.\\

Potential selection mechanism for schmidt states that fluctuate less, ie are stable in time?


\begin{figure}
    \centering
    \includegraphics[scale=0.4]{Figures/time_simi.png}
    \caption{Graphs of the similarity between s1, parameters $E_I=0.06$ and $w=0.3$.}
    \label{fig:time_simi}
\end{figure}

\subsection{...}

We have a certain sharing of the Hilbert space under measurement
This sharing implies certain difference in behavior for quantities such as Neff. And if possible, it would be amazing to recover this sharing from the shape of the spectrum and the distribution of the global state!  mad dog evrietian style.

Something that troubles me. q and w have a large impact on the  âshape âof the distribution. The way I used to see things. Is that the shape of the distribution was the determining factor to how the world would be, ie it would define it classically, ie macroscopically. And to me the 2 worlds couldnât me so different. But, this macro looking factor (distribution shape), might just be irrelevant.  

Could there be something to say about the fact that we are looking at overlap in the probability space? This is because of course the 2 worlds will be orthogonal in the Hilbert space. 
So our fundamental object of study is really their distribution in the total energy eigenbasis.



Pointer states: found using predicatibility sieve. They are the states that devellope the least entanglement with the environment in a robust manner.

So I guess we dont have pointer states in our case, since we dont have self interaction to vary the system state.

This dynamics of Schmdit basis states towards the pointer states might be worth studying. In the case of no self interaction for the system, the pointer states are eigenstates of the interaction Hamiltonian. Might be interesting to check.

Note the Schmidt basis does not have to be orthogonal.  
we have always orthogonal schmidt basis in our ACL case due to orthogonal system state + no self interaction.

(Andreas Albrecht study of Schmidt states dynamics under measurement:
https://journals.aps.org/prd/abstract/10.1103/PhysRevD.46.5504
https://journals.aps.org/prd/abstract/10.1103/PhysRevD.48.3768)

\subsubsection{Distinction between Schmidt and Pointers}
https://journals.aps.org/prd/abstract/10.1103/PhysRevD.40.1071



\subsubsection{A discussion of Schmidt might not be enough}
How pointers might not really be branches https://arxiv.org/pdf/gr-qc/9610028.pdf
Is a paper, looking at the possibility of s=using the schmidt decomposition to seelct the physics set of consistent histories. The find is that it would not be enought.
The schmidt basis is induced by ...

The pointer basis is induced by decoherence, or more precisely is einselected by the environment-system interaction

issue, isn't einselection only defined for S+M+E? while we are working here with S+E?

looking at the schmidt states has the nice property of always looking at 2 orthogonal states.

Are pointer states worlds? https://arxiv.org/abs/gr-qc/9610028 says that no

\appendix

\section{Spectrum of $H_{tot}$}


\subsection{Characterizing the spectrum of the Hamiltonian}
The Hamiltonian who's spectrum we are trying to characterize is composed of 3 parts, $\mathbbm{1}, \mathbbm{1}\otimes H_e,E_IH_q\otimes H_e'$. We are interested in the shape that the distribution of eigenvalues will take. $\mathbbm{1}$ will simply shift that distribution by +1, since it commutes with the other 2. \\

We will use the fact that the random matrices that appear in these Hamiltonians, are Gaussian Unitary Ensemble (GUE) matrices, and are known to have semi-circle spectrum distribution.
Wigner semi-circle law:
\begin{equation}
    f(E)=\frac{2}{\pi R^2}\sqrt{E^2-R^2}
\end{equation}
distribution between $[-R,R]$ bounds.\\

Considering $\mathbbm{1}\otimes H_{e}$, $H_{e}$ has spectrum $\sigma_2=\{\lambda_1,\lambda_2,...\lambda_{d_1}\}$ and the identity is here defined over Hilbert space of dimension $d_1$. This makes  the final spectrum $\sigma_{1,2}={\lambda_1, \lambda_1, ..., \lambda_1, \lambda_2, ...,\lambda_2, \lambda_3, ...}$, where each element of the spectrum is repeated $d_1$ times. The distribution of the spectrum of the first term is then an elevated Wigner semi-circle.
\begin{equation}
    f_{env}(E) = \frac{2}{\pi R^2}\sqrt{R^2-E^2} + d_1
\end{equation}

Considering $H_q\otimes H_{e}'$, with the spectrum of the random matrix $\sigma_2=\{\lambda_1',\lambda_2',...\lambda_{d_1}'\}$. We get a new spectrum,  $\sigma_{1,2}=0*\sigma_2\bigcup\sigma_2\bigcup2\sigma_2\bigcup ...\bigcup(d_1-1)\sigma_2$ ie $\sigma_{1,2}= \{0,...,0,\lambda_1', \lambda_2', ..., 2\lambda_1', 2\lambda_2',..., (d_1-1)\lambda_1',...\}$. This produces a sum of Wigner semi-circles with $R_i=i*R_1$ for $i=0,1..,d-1$.
\begin{equation}
    f_{int}(E) = E_I\sum_{j=1}^{d_1-1}\frac{2}{\pi j^2R^2}\sqrt{j^2R^2-E^2} + \delta_{E,0}d_2
\end{equation}
The $\delta_{E,0}d_2$ comes from our SHO having ground state energy $E_0=0$. The $E_I$ factor is added to the distribution here. Since these distributions are centered on 0, the factor $E_I$ acts as a spread factor. (ie the max and min are split $2E_I*R_{effective}$)\\

We verify that we do indeed get this in Fig.~(\ref{fig:wigner_sum}). 

\begin{figure}[h]
    \centering
    \includegraphics[scale=0.5]{Figures/Wigner_sum.png}
    \caption{The set of wigner semi-circles who's sum gives us the spectrum of $H_I$. The wider ones are for higher $q_i$'s.}
    \label{fig:wigner_sum}
\end{figure}

With our simulation we can also get them numerically as seen in Fig.~(\ref{fig:spectra}), we choose $E_I=0.06$ and $w=0.3$.
\begin{figure}
    \centering
    \includegraphics[scale = 0.5]{Figures/Spectra.png}
    \caption{First is the distribution of the state in the total energy eigenbasis. Second is the spectrum of that total energy eigenbasis. Third is the distribution of ythe spectrum of $\mathbbm{1}\otimes H_e$ in its own energy eigenbasis. We do see a Wigner semi-circle lifted up by 10. Finally is the distribution of the spectrum of $H_q\otimes H_e'$, which also matches a sum of 10 Wigner semi-circles with growing $R$. We also see the $200*\delta_{E,0}$ predicted at the center. Note that this last distribution has to be scaled down by the factor $E_I=0.06$ (in this case)}
    \label{fig:spectra}
\end{figure}

About Fig.~(\ref{fig:spectra}), it looks like $\sigma_{total}=\sigma_{env}+E_I\sigma_{int} + 1$ (+1 from identity matrix). But that would only be the case if both Hamiltonians where diagonalizable in a common basis, which they are not, being different independant random matrices. Is it still possible to consider the final spectrum as such? I do not see another way to characterize it.\\

{\color{teal} \textbf{The spectra look like they sum, even though the Hamiltonians do not commute}}

If we take the summing of the spectra as a correct approximation, we have characterized the shape of the total spectrum depending on $E_I$. 
\begin{equation}
    f_{total}(E) = \frac{2}{\pi R^2}\sqrt{R^2-E^2} + E_I\sum_{j=1}^{d_1-1}\frac{2}{\pi j^2R^2}\sqrt{j^2R^2-E^2} + \delta_{E,0}d_2 + d_1\theta(R^2-E^2)
\end{equation}
$\theta(x)$ is the Heaviside function. For the $H_{rand, d=200}$ $R\approx 10$.\\

Potential change to the model. The identity spectrum does not add anything interesting we could remove it. It might also be beneficial to make the GS of the SHO different from 0. 

\subsubsection{We use bounds on the values of the sum of 2 matrices.}

For 2 hermitian matrices $A,B$ such that $A+B=C$. with ordered eigenvalues, we have,
\begin{equation}
    c_{i+j-1}\leq a_i+b_j\quad\text{and}\quad c_{n-i-j}\geq a_{n-i}+b_{n-j}
\end{equation}
This means for us that
\begin{equation}
    f_{total}(E)\leq \frac{2}{\pi R^2}\sqrt{R^2-(E-e)^2} + d_1 + E_I\sum^{d_1-1}_{j=1}\frac{2}{\pi j^2 R^2}\sqrt{j^2R^2-e^2} +\delta_{E,0}d_2
\end{equation}

\subsection{Overlap $|r(t)|^2$ for $H_I$ dominated but no conditions on energy spectrums}
We again take a case where both blocks of $H_I$ in question are diagonalizable together but have different energy spectrum, we dont specify the spectrum shape this time. Note again that this not in the context of worlds that are not defined the same same eigenstate, in this one they are and we might show here that it is very difficult to achieve decoherence then... ie, is it a delicate balance to have orthogonality and sharing of eigenspaces? 
\begin{align}
    |w_1\rangle = \frac{1}{\sqrt{d_2}}\sum_ke^{-itE_k}|k\rangle\\
    |w_2\rangle = \frac{1}{\sqrt{d_2}}\sum_ke^{-itE_k'}|k\rangle
\end{align}
and,
\begin{align}
    |r(t)|^2=|\langle w_2(t)|w_1(t)\rangle|^2 = \frac{1}{d_2^2}\sum_{kj}e^{-it((E_k-E_j)-(E_k'-E_j'))}\\
    =\frac{1}{d_2^2}(\sum_{kj}e^{-itA_{kj}})\\
    =\frac{1}{d_2^2}(d_2+2\sum^{d_2}_{k=1}\sum^{k-1}_{j=0}cos(tA_{kj}))
\end{align}
From this can we study how finely tunned the frequencies have to be to cause decoherence? Or is there always a decoherence like behavior here? 

\end{document}
